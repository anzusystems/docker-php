AnzuSystems PHP Development Docker Images by Petit Press a.s. (www.sme.sk)
=====

Main PHP docker images from which all our PHP flavors (versions with base, vipsffmpeg...) are built. It is based on [official PHP images](https://hub.docker.com/_/php) using our custom configuration.
Additionally, it has preinstalled some libraries (xdebug, libvips, redis, mongodb...). Also contains [nginx](https://nginx.org/).

-----

## What's inside

- PHP8.1 - 8.1.17
- PHP8.2 - 8.2.4
- PHP Mongodb ext - 1.15.1
- PHP Redis ext - 5.3.7
- PHP Pcov ext - 1.0.11
- PHP Xdebug ext - 3.2.0
- Redis (client) - 6.2.7
- Supervisor - 4.2.2
- Composer - 2.5.5
- Vipsffmpeg variant:
  - PHP Vips ext - 1.0.13
  - FFmpeg - 4.3.4
  - LibVips - 8.14.2
- Nginx variant:
  - Nginx - 1.24.0
  - Nginx-xslt - 1.24.0
  - Nginx-geoip - 1.24.0
  - Nginx-image-filter - 1.24.0
  - Nginx-njs - 0.7.12

### Special common commands

- `cron-cmd` - Cron script wrapper to run command with multiple options
- `create-user` - Script to create user with provided UID and GID and fix permissions for folders
- `generate-messenger-supervisor-conf` - Script to generate messenger supervisor conf files inside the container
- `start-messenger` - Script used to start messenger inside the container

## Git Hooks

Setup pre-commit hook:

- `.git/hooks/pre-commit`

      #!/bin/bash
      #
      # Run update.sh script before commit

      ./update.sh
      git add .github build

## Auto-generation

Script:

    ./update.sh

This script has to be run before every commit.

Script is used to autogenerate following files/folders:

- `build/phpXY/cli/` - autogenerated from:
    - `config/all/`
    - `config/all-X.Y/`
    - `template.Dockerfile`
    - `variant-*.Dockerfile`
    - `versions.conf`
- `build/phpXY/fpm/` - autogenerated from:
    - `config/all/`
    - `config/all-X.Y/`
    - `config/fpm/`
    - `config/fpm-X.Y/`
    - `config/fpm-nginx/`
    - `template.Dockerfile`
    - `variant-*.Dockerfile`
    - `versions.conf`
- `.github/workflows/docker.yml` - autogenerated from:
    - `docker.yml.template`
    - `docker.yml.job.template`

Do not change autogenerated files/folders directly.
